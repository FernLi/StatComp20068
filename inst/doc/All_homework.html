<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="By 20068" />

<meta name="date" content="2020-12-19" />

<title>All_homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All_homework</h1>
<h4 class="author">By 20068</h4>
<h4 class="date">2020-12-19</h4>



<div id="hw-2020-09-22" class="section level1">
<h1>HW-2020-09-22</h1>
<div id="question-1-use-knitr-to-produce-an-example-which-should-contain-texts-and-at-least-one-figure." class="section level2">
<h2>Question 1 : Use knitr to produce an example which should contain texts and at least one figure.</h2>
</div>
<div id="answer" class="section level2">
<h2>Answer :</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ctl &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>trt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>group &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Ctl&quot;</span>,<span class="st">&quot;Trt&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a>weight &lt;-<span class="st"> </span><span class="kw">c</span>(ctl, trt)</span>
<span id="cb1-5"><a href="#cb1-5"></a>lm.D9 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span>group)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">plot</span>(lm.D9)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-use-knitr-to-produce-an-example-which-should-contains-texts-and-at-least-one-table." class="section level2">
<h2>Question 2 : Use knitr to produce an example which should contains texts and at least one table.</h2>
</div>
<div id="answer-1" class="section level2">
<h2>Answer :</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span> (<span class="kw">head</span>(iris))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
<div id="question-3-use-knitr-to-produce-an-example-which-should-contain-at-least-a-couple-of-latex-formulas." class="section level2">
<h2>Question 3 : Use knitr to produce an example which should contain at least a couple of LaTeX formulas.</h2>
</div>
<div id="answer-2" class="section level2">
<h2>Answer :</h2>
<ul>
<li><p>A simple formula</p>
<p><span class="math display">\[A_1+A_2=0\]</span></p></li>
<li><p>A complicated formula</p>
<p><span class="math display">\[A_{i,j}=\frac{1}{(k_j-i)!} \frac{d^{k_j-i}}{ds^{k_j-i}} \{ \frac{T_{m-1}(s)}{\Pi_{l=1,l \neq j}^n (s-R_l)^{k_l}} \} |_{s=R_j}\]</span></p></li>
</ul>
</div>
</div>
<div id="hw-2020-09-29" class="section level1">
<h1>HW-2020-09-29</h1>
<div id="question-1" class="section level2">
<h2>Question 1 :</h2>
<p>The Pareto(a,b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^{a}, \quad \quad x \geq b &gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer :</h2>
<p><span class="math inline">\(U=F(x) \sim U[0,1]\)</span>,then <span class="math inline">\(U=F(x)=1-(\frac{b}{x})^a,x \geq b&gt;0,a&gt;0\)</span>.</p>
<p>According <span class="math inline">\(U=1-(\frac{b}{x})^a\)</span>,then we can deduce <span class="math inline">\(x=\frac{b}{(1-U)^{\frac{1}{a}}}\)</span> and calculate the density function <span class="math inline">\(f(x)=(F(x))&#39;=\frac{ab^a }{x^{a+1}},x \geq b\)</span>.</p>
<p>Now, we use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution and Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>n=<span class="dv">100</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x=<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u)  <span class="co">#F(x)=1-(2/x)^2 ,x&gt;=b&gt;0,a&gt;0</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a>y=<span class="kw">seq</span>(<span class="dv">2</span>,<span class="kw">max</span>(x),<span class="fl">0.01</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(y<span class="op">^</span><span class="dv">3</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2 :</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2), \quad \quad |x| \leq 1\]</span> Devroye and Gyorfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3 \sim Uniform(-1,1)\)</span>. If <span class="math inline">\(|U_3| \geq |U_2|\)</span> and<span class="math inline">\(|U_3| \geq |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span> ; otherwise deliver<span class="math inline">\(U_3\)</span> . Write a function to generate random variates from <span class="math inline">\(f_e\)</span> , and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer :</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>n=<span class="dv">10000</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>u1=<span class="dv">2</span><span class="op">*</span><span class="kw">runif</span>(n)<span class="op">-</span><span class="dv">1</span>;u2=<span class="dv">2</span><span class="op">*</span><span class="kw">runif</span>(n)<span class="op">-</span><span class="dv">1</span>;u3=<span class="dv">2</span><span class="op">*</span><span class="kw">runif</span>(n)<span class="op">-</span><span class="dv">1</span>;</span>
<span id="cb4-3"><a href="#cb4-3"></a>x=<span class="kw">vector</span>();</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="cf">if</span> (<span class="kw">abs</span>(u3[i])<span class="op">&gt;</span><span class="kw">abs</span>(u2[i]) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3[i])<span class="op">&gt;</span><span class="kw">abs</span>(u1[i])){</span>
<span id="cb4-6"><a href="#cb4-6"></a>    x[i]=u2[i]</span>
<span id="cb4-7"><a href="#cb4-7"></a>    }<span class="cf">else</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    x[i]=u3[i]</span>
<span id="cb4-9"><a href="#cb4-9"></a>}</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb4-11"><a href="#cb4-11"></a>y=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="kw">lines</span>(y,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3 :</h2>
<p>Prove that the algorithm given in question 2 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer :</h2>
<p>第一步：先求解<span class="math inline">\(|f_e|\)</span>的密度函数，令<span class="math inline">\(X=|U_1|,Y=|U_2|,Z=|U_3|\)</span>,则由上题算法知： <span class="math display">\[
W=\begin{cases}
Y \quad  &amp; Z \geq max\{X,Y\} \\
Z  \quad  &amp; Z &lt;max\{ X,Y\}
\end{cases}\]</span></p>
<p>a.求解<span class="math inline">\(W\)</span>的分布函数： <span class="math display">\[
\begin{aligned}
P(W \leq w)&amp;=P(Y\leq w,Z\geq max\{X,Y\})+P(Z\leq w,Z&lt; max\{X,Y\})  \\
&amp;=\int_0^w \int_0^1 \int_{max\{X,Y\}}^1 1 dzdxdy+\int_0^1 \int_0^1 \int_0^{min\{w,max\{X,Y\}\}} 1 dzdxdy \\
&amp;= I+II
\end{aligned}\]</span></p>
<p>b.计算<span class="math inline">\(I,II\)</span> <span class="math display">\[
 I=\begin{aligned}
 \int_0^w \int_0^1 \int_{max\{X,Y\}}^1 1 dzdxdy &amp;=\int_0^w \int_0^1 1-max\{X,Y\} dx dy =-\frac{1}{6}w^3+\frac{1}{2}w
 \end{aligned}\]</span> 对式子<span class="math inline">\(II\)</span>分类讨论，计算如下： <span class="math display">\[
\begin{aligned}
II&amp;=  \int_w^1 \int_x^1 w dydx +\int_w^1 \int_w^x w dydx  + \int_w^1 \int_0^w w dy dx +  \int_0^w \int_w^1 w dydx + \int_0^w \int_x^w y dydx  +  \int_0^w \int_0^x dydx   \\
&amp;=w-\frac{1}{3}w^3
\end{aligned}\]</span> 因此<span class="math inline">\(P(W \leq w)=\frac{w}{2}-\frac{w^3}{6}+w-\frac{w^3}{3}=\frac{3w}{2}-\frac{w^3}{2}\)</span></p>
<p>第二步：计算密度函数：</p>
<p>分布函数<span class="math inline">\(F(w)=\frac{3w}{2}-\frac{w^3}{2}\)</span>，密度函数<span class="math inline">\(f(w)=\frac{3}{2}-\frac{3w^2}{2}\)</span>。由<span class="math inline">\(f_e\)</span>为对称函数，将其密度函数除2可得：<span class="math inline">\(f_e(w)=\frac{3}{4}(1-w^2),w \in [-1,1]\)</span></p>
<p>Use Kolmogorov-Smirnov test to test whether variables follow F distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>F=<span class="op">-</span><span class="fl">0.25</span><span class="op">*</span>y<span class="op">^</span><span class="dv">3</span><span class="fl">+0.75</span><span class="op">*</span>y<span class="fl">+0.5</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">ks.test</span>(x,F)</span></code></pre></div>
<pre><code>## 
##  Two-sample Kolmogorov-Smirnov test
## 
## data:  x and F
## D = 0.5034, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>The p value calculated by ks test is 2.2e-16,it Prove that the algorithm given in question 2 generates variates from the density.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4 :</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r,\quad y \geq 0\]</span> (This is an alternative parameterization of the Pareto cdf given in question 1.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graph- ing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer :</h2>
<p>According <span class="math inline">\(r=4,\beta=2,F(y)=1-(\frac{\beta}{\beta+y})^r=1-(\frac{2}{2+y})^4=U \sim U[0,1]\)</span>,then deduce <span class="math inline">\(y=\frac{2}{(1-u)^{1/4}}-2\)</span> and <span class="math inline">\(f(y)=(F(y))&#39;=64(2+y)^{-5}\)</span></p>
<p>Now, we use the inverse transform method to simulate a random sample from the <span class="math inline">\(F(y)\)</span> distribution and Graph the density histogram of the sample with the <span class="math inline">\(F(y)\)</span> density superimposed for comparison.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">70</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>n=<span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4"></a>x=<span class="dv">2</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))<span class="op">-</span><span class="dv">2</span>  <span class="co">#F(x)=1-(2/x)^2 ,x&gt;=b&gt;0,a&gt;0</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>}))</span>
<span id="cb7-6"><a href="#cb7-6"></a>y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(x),<span class="fl">0.01</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw-2020-10-13" class="section level1">
<h1>HW-2020-10-13</h1>
<div id="exercises-5.1" class="section level2">
<h2>Exercises 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math inline">\(\int_0^{\frac{\pi}{3}} sin (t) dt\)</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="solve." class="section level2">
<h2>Solve.</h2>
<p><span class="math inline">\(\int_0^{\frac{\pi}{3}} sin(t)dt=\frac{\pi}{3}\int_0^{\frac{\pi}{3}} sin(t)\frac{3}{\pi}dt=\frac{\pi}{3} E[sin(u)],u \sim U[0,1]\)</span></p>
<p><span class="math inline">\(\int_0^{\frac{\pi}{3}} sin(t)dt=-cos(t)|_0^{\frac{\pi}{3}}=1/2\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">66</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>number=<span class="dv">1000000</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>exact_value=<span class="dv">1</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>u=<span class="kw">runif</span>(number,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>MC_value=pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">mean</span>(<span class="kw">sin</span>(u))</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">print</span>(<span class="kw">c</span>(MC_value,exact_value,<span class="kw">abs</span>(MC_value<span class="op">-</span>exact_value)))</span></code></pre></div>
<pre><code>## [1] 5.000377e-01 5.000000e-01 3.766845e-05</code></pre>
<p>Therefore, the estimated value is 5.000377e-01 and the theoretical value is 0.5</p>
</div>
<div id="exercises-5.7" class="section level2">
<h2>Exercises 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="solve.-1" class="section level2">
<h2>Solve.</h2>
<p><span class="math inline">\(\theta=\int_0^1 e^x dx=e-1\)</span></p>
<p><span class="math inline">\(\hat{\theta}_1=\frac{1}{2m} \sum_{i=1}^m [e^{u_i}+e^{1-{u_i}}],u_i \sim U[0,1]\)</span></p>
<p><span class="math inline">\(\hat{\theta}_2=E(e^U)=\frac{1}{m} \sum_{i=1}^m e^{u_i},u_i \sim U[0,1]\)</span></p>
<p><span class="math inline">\(var(e^U)=E[e^{2U}]-(E[e^U])^2=0.2420\)</span></p>
<p><span class="math inline">\(cov(e^U,e^{1-U})=E[e^Ue^{1-U}]-E[e^U]E[e^{1-U}]=e-(e-1)^2=-0.2342\)</span></p>
<p><span class="math inline">\(var(\frac{e^{U_1}+e^{U_2}}{2})=var(e^U)/2=0.1210\)</span></p>
<p><span class="math inline">\(Var(\frac{e^U+e^{1-U}}{2})=Var(\frac{e^U}{2})+Var(\frac{e^{1-U}}{2})+2cov(\frac{e^U}{2},\frac{e^{1-U}}{2})=\frac{e^2-1+2e-4(e-1)^2}{4}=0.0039\)</span></p>
<p>The theoretical value of the percentage reduction of variance should be <span class="math inline">\(\frac{0.1210-0.0039}{0.1210} \approx 0.967\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">66</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>number=<span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>exact_value=<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>n=<span class="dv">1000</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>MC_value1=<span class="kw">vector</span>()</span>
<span id="cb10-6"><a href="#cb10-6"></a>MC_value2=<span class="kw">vector</span>()</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb10-8"><a href="#cb10-8"></a>  u1=<span class="kw">runif</span>(number)</span>
<span id="cb10-9"><a href="#cb10-9"></a>  u2=<span class="kw">runif</span>(number)</span>
<span id="cb10-10"><a href="#cb10-10"></a>  MC_value1[i]=<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(<span class="kw">exp</span>(u1)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u1))</span>
<span id="cb10-11"><a href="#cb10-11"></a>  MC_value2[i]=<span class="kw">mean</span>((<span class="kw">exp</span>(u1)<span class="op">+</span><span class="kw">exp</span>(u2))<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a>}</span>
<span id="cb10-13"><a href="#cb10-13"></a>sd1=<span class="kw">sd</span>(MC_value1)</span>
<span id="cb10-14"><a href="#cb10-14"></a>sd2=<span class="kw">sd</span>(MC_value2)</span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="kw">print</span>(<span class="kw">c</span>(exact_value,<span class="kw">mean</span>(MC_value1),<span class="kw">mean</span>(MC_value2),sd1,sd2))</span></code></pre></div>
<pre><code>## [1] 1.718281828 1.718383530 1.718690689 0.002005904 0.010725576</code></pre>
<p>Therefore, the empirical estimate of the percent reduction in variance using the antithetic variate is</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(MC_value1)<span class="op">/</span><span class="kw">var</span>(MC_value2))</span></code></pre></div>
<pre><code>## [1] 0.9650233</code></pre>
<p>So the empirical estimate of the percentage reduction in variance is close to the theoretical value.</p>
</div>
<div id="exercises-5.11" class="section level2">
<h2>Exercises 5.11</h2>
<p>If <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are antithetic, we derived that<span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c \hat{\theta}_1+(1-c)\hat{\theta}_2\)</span> . Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span>and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of θ, ﬁnd the value c ∗ that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c=c \hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="prove" class="section level2">
<h2>Prove:</h2>
<p>Because of <span class="math inline">\(\hat{\theta}_c=c \hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>,We can derive that: <span class="math display">\[
\begin{aligned}
var(\hat{\theta}_c)&amp;=var(c \hat{\theta}_1+(1-c)\hat{\theta}_2)\\
&amp;=c^2 var(\hat{\theta}_1)+(1-c)^2 var(\hat{\theta}_2)+2c(1-c)cov(\hat{\theta}_1,\hat{\theta}_2) \\
&amp;=c^2[var(\hat{\theta}_1)+var(\hat{\theta}_2)-2cov(\hat{\theta}_1,\hat{\theta}_2)]+c[2cov(\hat{\theta}_1,\hat{\theta}_2)-2var(\hat{\theta}_2)]+var(\hat{\theta}_2) \\
&amp;=c^2 var(\hat{\theta}_1-\hat{\theta}_2)+c[2cov(\hat{\theta}_1,\hat{\theta}_2)-2var(\hat{\theta}_2)]+var(\hat{\theta}_2) 
\end{aligned}
\]</span> Therefore, according to the above derivation,when <span class="math display">\[c^*=-\frac{b}{2a}=-\frac{cov(\hat{\theta}_1,\hat{\theta}_2)-var(\hat{\theta}_2)}{ var(\hat{\theta}_1-\hat{\theta}_2)}\]</span> The variance can be minimized.</p>
<p>If <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are antithetic,then we know that <span class="math inline">\(\hat{\theta_1}+\hat{\theta_2}=1\)</span>. <span class="math display">\[\begin{aligned}
cov(\hat{\theta_1},\hat{\theta_2})&amp;=cov(\hat{\theta_1},1-\hat{\theta_1})=-var(\hat{\theta_1}) \\
c^*&amp;=\frac{cov(\hat{\theta}_1,\hat{\theta}_2)-var(\hat{\theta}_2)}{ var(\hat{\theta}_1-\hat{\theta}_2)}=\frac{1}{2}
\end{aligned}\]</span></p>
</div>
</div>
<div id="hw-2020-10-20" class="section level1">
<h1>HW-2020-10-20</h1>
<div id="exercises-5.13" class="section level2">
<h2>Exercises 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span>and<span class="math inline">\(f_2\)</span>that are supported on <span class="math inline">\((0,\infty)\)</span> and are ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}, x&gt;1\)</span>,Which of your two importance functions should produce the smaller variance in estimating<span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} dx\)</span> by importance sampling? Explain.</p>
</div>
<div id="solve.-2" class="section level2">
<h2>Solve.</h2>
<p>Suppose <span class="math inline">\(f_1(x)=xe^{\frac{1-x^2}{2}}\)</span> and <span class="math inline">\(f_2(x)=e^{-x}\)</span></p>
<p>use the inverse transformation method for the <span class="math inline">\(f_1(x)\)</span> function:</p>
<p><span class="math inline">\(F_1(x)=\int_1^x f_1(x)dx=1-e^{\frac{1-x^2}{2}}=U \sim U[0,1] \Rightarrow x=\sqrt{1-2log(1-u)}\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>m=<span class="dv">10000</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>theta.hat=var.hat=<span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>g=<span class="cf">function</span>(x){</span>
<span id="cb14-5"><a href="#cb14-5"></a>  (x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>}</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>u=<span class="kw">runif</span>(m)                    <span class="co">##inverse transform method </span></span>
<span id="cb14-9"><a href="#cb14-9"></a>x=<span class="kw">sqrt</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))    </span>
<span id="cb14-10"><a href="#cb14-10"></a>fg1=<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x)</span>
<span id="cb14-11"><a href="#cb14-11"></a>theta.hat[<span class="dv">1</span>]=<span class="kw">mean</span>(fg1)</span>
<span id="cb14-12"><a href="#cb14-12"></a>var.hat[<span class="dv">1</span>]=<span class="kw">var</span>(fg1)</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a>x=<span class="kw">rexp</span>(m,<span class="dv">1</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>fg2=<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x))</span>
<span id="cb14-16"><a href="#cb14-16"></a>theta.hat[<span class="dv">2</span>]=<span class="kw">mean</span>(fg2)</span>
<span id="cb14-17"><a href="#cb14-17"></a>var.hat[<span class="dv">2</span>]=<span class="kw">var</span>(fg2)</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="kw">print</span>(<span class="kw">rbind</span>(theta.hat,var.hat))</span></code></pre></div>
<pre><code>##                 [,1]      [,2]
## theta.hat 0.40129699 0.4016908
## var.hat   0.01541051 0.3419579</code></pre>
<p>By using importance functions<span class="math inline">\(f_1(x),f_2(x)\)</span>, We get the variance of the estimated value as 0.01541051 and 0.3419579.So the function <span class="math inline">\(f_1(x)\)</span>produces the smaller variance.</p>
</div>
<div id="exercises-5.15" class="section level2">
<h2>Exercises 5.15</h2>
<p>Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="solve.-3" class="section level2">
<h2>Solve.</h2>
<p><span class="math inline">\(g(x)=\frac{e^{-x}}{1+x^2},x \in (0,1)\)</span></p>
<p><span class="math inline">\(f(x)=\frac{e^{-x}}{e^{-\frac{i-1}{5}}-e^{-\frac{i}{5}}}, x \in (\frac{i-1}{5},\frac{i}{5})\)</span></p>
<p><span class="math inline">\(\int_0^1 g(x)dx=\sum_{i=1}^5 \int_{\frac{i-1}{5}}^{\frac{i}{5}} g(x)dx =\sum_{i=1}^5 \int_{\frac{i-1}{5}}^{\frac{i}{5}} \frac{g(x)}{f(x)} f(x)dx =\sum_{i=1}^5 E(\frac{g(x)}{f(x)}) \quad x \in (\frac{i-1}{5},\frac{i}{5})\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>m=<span class="dv">100</span>;k=<span class="dv">5</span>;r=m<span class="op">/</span>k;n=<span class="dv">50</span>;t2=<span class="kw">numeric</span>(k)</span>
<span id="cb16-3"><a href="#cb16-3"></a>estimates=<span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>g=<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb16-6"><a href="#cb16-6"></a>f=<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))}</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb16-9"><a href="#cb16-9"></a>  estimates[i,<span class="dv">1</span>]=<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m)))</span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="cf">for</span> ( j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb16-11"><a href="#cb16-11"></a>    u=<span class="kw">runif</span>(m<span class="op">/</span>k)</span>
<span id="cb16-12"><a href="#cb16-12"></a>    x=<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb16-13"><a href="#cb16-13"></a>    t2[j]=<span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x))</span>
<span id="cb16-14"><a href="#cb16-14"></a>  }</span>
<span id="cb16-15"><a href="#cb16-15"></a>  estimates[i,<span class="dv">2</span>]=<span class="kw">sum</span>(t2)</span>
<span id="cb16-16"><a href="#cb16-16"></a>}</span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="kw">apply</span>(estimates,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5246927 0.5248410</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">apply</span>(estimates,<span class="dv">2</span>,var)</span></code></pre></div>
<pre><code>## [1] 6.392113e-04 3.299438e-06</code></pre>
<p>This represents a more than 99.4% reduction in variance.</p>
</div>
<div id="exercises-6.4" class="section level2">
<h2>Exercises 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n\)</span>are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% conﬁdence interval for the parameter <span class="math inline">\(u\)</span> . Use a Monte Carlo method to obtain an empirical estimate of the conﬁdence level.</p>
</div>
<div id="solve.-4" class="section level2">
<h2>Solve.</h2>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n \overset{iid}{\sim} LN(u,\sigma^2)\)</span>, then <span class="math inline">\(log(X_1), \dots,log(X_n) \overset{iid}{\sim} N(u,\sigma^2)\)</span>.Because the parameter <span class="math inline">\(\sigma\)</span> is unknown, construct statistics:<span class="math display">\[T=\frac{\sqrt{n}(\bar{Y}-u)}{S} \sim t(n-1)\]</span> and <span class="math inline">\(Y_i=log(X_i),S=\sqrt{S^2}\)</span>,<span class="math inline">\(S^2\)</span> is the variance of the sample <span class="math inline">\((Y_1,\dots,Y_n)\)</span>. Therefore, the <span class="math inline">\(1-\alpha\)</span> confidence interval of the parameter <span class="math inline">\(u\)</span> is<span class="math display">\[[\bar{Y}-\frac{S}{\sqrt{n}} t_{\frac{\alpha}{2}}(n-1),\bar{Y}+\frac{S}{\sqrt{n}} t_{\frac{\alpha}{2}}(n-1)]\]</span> take <span class="math inline">\(\alpha=0.05\)</span>, then we can get confidence interval of the parameter <span class="math inline">\(u\)</span>. Draw 20 samples from the population <span class="math inline">\(LN(0,1)\)</span> each time, repeat 100000 times, and perform Monte Carlo simulation to get the confidence level estimate as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>n=<span class="dv">20</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>u=<span class="dv">0</span>;sigma=<span class="dv">1</span>;</span>
<span id="cb20-5"><a href="#cb20-5"></a>number=<span class="dv">100000</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>Icl=<span class="kw">vector</span>();ucl=<span class="kw">vector</span>();</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>number){</span>
<span id="cb20-9"><a href="#cb20-9"></a>  x=<span class="kw">rnorm</span>(n,<span class="dt">mean =</span> u,<span class="dt">sd=</span>sigma)</span>
<span id="cb20-10"><a href="#cb20-10"></a>  s=<span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>n<span class="op">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb20-11"><a href="#cb20-11"></a>  ucl[i]=<span class="kw">mean</span>(x)<span class="op">+</span>s<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb20-12"><a href="#cb20-12"></a>  Icl[i]=<span class="kw">mean</span>(x)<span class="op">-</span>s<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb20-13"><a href="#cb20-13"></a>}</span>
<span id="cb20-14"><a href="#cb20-14"></a>Icl1=<span class="kw">mean</span>(Icl);ucl1=<span class="kw">mean</span>(ucl)</span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a>a=<span class="dv">0</span>;</span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>number){</span>
<span id="cb20-18"><a href="#cb20-18"></a>  <span class="cf">if</span> (Icl[i]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;&amp;</span>ucl[i]<span class="op">&gt;</span><span class="dv">0</span>)a=a<span class="op">+</span><span class="dv">1</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>  <span class="cf">else</span> a=a</span>
<span id="cb20-20"><a href="#cb20-20"></a>}</span>
<span id="cb20-21"><a href="#cb20-21"></a>p=a<span class="op">/</span>number</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="kw">print</span>(<span class="kw">c</span>(Icl1,ucl1))</span></code></pre></div>
<pre><code>## [1] -0.4740950  0.4736912</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.95506</code></pre>
<p>The result is that 95506 intervals satisfied (Icl&lt;0&lt;ucl), so the empirical confidence level is 95.506% in this experiment. The result will vary but should be close to the theoretical value, 95%.</p>
</div>
<div id="exercises-6.5" class="section level2">
<h2>Exercises 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the conﬁdence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="solve.-5" class="section level2">
<h2>Solve.</h2>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n \overset{iid}{\sim} \chi^2(2)\)</span>. construct statistics:<span class="math display">\[T=\frac{\sqrt{n}(\bar{X}-u)}{S} \sim t(n-1)\]</span> and <span class="math inline">\(S^2\)</span> is the variance of the sample <span class="math inline">\((X_1,\dots,X_n)\)</span>. Therefore, the <span class="math inline">\(1-\alpha\)</span> confidence interval of the parameter <span class="math inline">\(u\)</span> is<span class="math display">\[[\bar{X}-\frac{S}{\sqrt{n}} t_{\frac{\alpha}{2}}(n-1),\bar{X}+\frac{S}{\sqrt{n}} t_{\frac{\alpha}{2}}(n-1)]\]</span> take <span class="math inline">\(\alpha=0.05\)</span>, then we can get confidence interval of the parameter <span class="math inline">\(u\)</span>. Draw 20 samples from the population <span class="math inline">\(\chi^2(2)\)</span> each time, repeat 100000 times, and perform Monte Carlo simulation to get the confidence level estimate as follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>n=<span class="dv">20</span>;alpha=<span class="fl">0.05</span>;number=<span class="dv">1000</span>;</span>
<span id="cb24-3"><a href="#cb24-3"></a>Icl=<span class="kw">vector</span>();ucl=<span class="kw">vector</span>();</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>number){</span>
<span id="cb24-6"><a href="#cb24-6"></a>  x=<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a>  s=<span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>n<span class="op">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb24-8"><a href="#cb24-8"></a>  ucl[i]=<span class="kw">mean</span>(x)<span class="op">+</span>s<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a>  Icl[i]=<span class="kw">mean</span>(x)<span class="op">-</span>s<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a>}</span>
<span id="cb24-11"><a href="#cb24-11"></a>Icl1=<span class="kw">mean</span>(Icl);ucl1=<span class="kw">mean</span>(ucl)</span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a>a=<span class="dv">0</span>;</span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>number){</span>
<span id="cb24-15"><a href="#cb24-15"></a>  <span class="cf">if</span> (Icl[i]<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;&amp;</span>ucl[i]<span class="op">&gt;</span><span class="dv">2</span>)a=a<span class="op">+</span><span class="dv">1</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="cf">else</span> a=a</span>
<span id="cb24-17"><a href="#cb24-17"></a>}</span>
<span id="cb24-18"><a href="#cb24-18"></a>p=a<span class="op">/</span>number</span>
<span id="cb24-19"><a href="#cb24-19"></a></span>
<span id="cb24-20"><a href="#cb24-20"></a><span class="kw">print</span>(<span class="kw">c</span>(Icl1,ucl1))</span></code></pre></div>
<pre><code>## [1] 1.086875 2.915805</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.931</code></pre>
<p>The result is that 92357 intervals satisfied (Icl&lt;2&lt;ucl), so the empirical confidence level is 92.357% in this experiment. The result is far from the 95% coverage under <span class="math inline">\(\chi^2(2)\)</span>.</p>
</div>
</div>
<div id="hw-2020-10-27" class="section level1">
<h1>HW-2020-10-27</h1>
<div id="exercises-6.7" class="section level2">
<h2>Exercises 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>?</p>
</div>
<div id="solve.-6" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>sk =<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb28-4"><a href="#cb28-4"></a>  xbar =<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb28-5"><a href="#cb28-5"></a>  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a>  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb28-8"><a href="#cb28-8"></a>}</span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co"># beta(a,a)</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>pwr_beta =<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb28-12"><a href="#cb28-12"></a> alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb28-13"><a href="#cb28-13"></a> n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb28-14"><a href="#cb28-14"></a> m =<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb28-15"><a href="#cb28-15"></a> N =<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb28-16"><a href="#cb28-16"></a> pwr =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb28-17"><a href="#cb28-17"></a> cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb28-18"><a href="#cb28-18"></a> </span>
<span id="cb28-19"><a href="#cb28-19"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb28-20"><a href="#cb28-20"></a>  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb28-21"><a href="#cb28-21"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb28-22"><a href="#cb28-22"></a>   x =<span class="st"> </span><span class="kw">rbeta</span>(n, a[j], a[j])</span>
<span id="cb28-23"><a href="#cb28-23"></a>   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb28-24"><a href="#cb28-24"></a>  }</span>
<span id="cb28-25"><a href="#cb28-25"></a>  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb28-26"><a href="#cb28-26"></a> }</span>
<span id="cb28-27"><a href="#cb28-27"></a> se =<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb28-28"><a href="#cb28-28"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pwr =</span> pwr,<span class="dt">se =</span> se))</span>
<span id="cb28-29"><a href="#cb28-29"></a>}</span>
<span id="cb28-30"><a href="#cb28-30"></a></span>
<span id="cb28-31"><a href="#cb28-31"></a> a =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">1</span>),<span class="kw">seq</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb28-32"><a href="#cb28-32"></a> pwr =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>pwr</span>
<span id="cb28-33"><a href="#cb28-33"></a> <span class="co"># plot the power</span></span>
<span id="cb28-34"><a href="#cb28-34"></a> se =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>se</span>
<span id="cb28-35"><a href="#cb28-35"></a> <span class="kw">plot</span>(a, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb28-36"><a href="#cb28-36"></a> <span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb28-37"><a href="#cb28-37"></a> <span class="kw">lines</span>(a, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb28-38"><a href="#cb28-38"></a> <span class="kw">lines</span>(a, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-6.8" class="section level2">
<h2>Exercises 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test . of equal variance, at signiﬁcance level <span class="math inline">\(\hat{\alpha} \overset{.}{=} 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="solve.-7" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>m=<span class="dv">1000</span>;alpha=<span class="fl">0.055</span>;</span>
<span id="cb29-3"><a href="#cb29-3"></a>sigma1=<span class="dv">1</span>;sigma2=<span class="fl">1.5</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>number1=<span class="kw">numeric</span>(m);number2=<span class="kw">numeric</span>(m)</span>
<span id="cb29-5"><a href="#cb29-5"></a>pwr1=<span class="kw">numeric</span>(<span class="dv">3</span>);pwr2=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a>count5test=<span class="cf">function</span>(x,y){</span>
<span id="cb29-8"><a href="#cb29-8"></a>  x=x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb29-9"><a href="#cb29-9"></a>  y=y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  outx=<span class="kw">sum</span>(x<span class="op">&gt;</span><span class="kw">max</span>(y))<span class="op">+</span><span class="kw">sum</span>(x<span class="op">&lt;</span><span class="kw">min</span>(y))</span>
<span id="cb29-11"><a href="#cb29-11"></a>  outy=<span class="kw">sum</span>(y<span class="op">&gt;</span><span class="kw">max</span>(x))<span class="op">+</span><span class="kw">sum</span>(y<span class="op">&lt;</span><span class="kw">min</span>(x))</span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy))<span class="op">&gt;=</span><span class="dv">5</span>))</span>
<span id="cb29-13"><a href="#cb29-13"></a>}</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a>a=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">2000</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb29-17"><a href="#cb29-17"></a>  n1=a[i];n2=a[i];</span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb29-19"><a href="#cb29-19"></a>    x=<span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="kw">sqrt</span>(sigma1))</span>
<span id="cb29-20"><a href="#cb29-20"></a>    y=<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="kw">sqrt</span>(sigma2))</span>
<span id="cb29-21"><a href="#cb29-21"></a>    s1=<span class="kw">var</span>(x)</span>
<span id="cb29-22"><a href="#cb29-22"></a>    s2=<span class="kw">var</span>(y)</span>
<span id="cb29-23"><a href="#cb29-23"></a>    F_value=s1<span class="op">/</span>s2</span>
<span id="cb29-24"><a href="#cb29-24"></a>    number1[j]=<span class="kw">count5test</span>(x,y)</span>
<span id="cb29-25"><a href="#cb29-25"></a>    number2[j]=<span class="kw">as.integer</span>(F_value<span class="op">&gt;</span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n1<span class="dv">-1</span>,n2<span class="dv">-1</span>)<span class="op">||</span>F_value<span class="op">&lt;</span><span class="kw">qf</span>(alpha<span class="op">/</span><span class="dv">2</span>,n1<span class="dv">-1</span>,n2<span class="dv">-1</span>))</span>
<span id="cb29-26"><a href="#cb29-26"></a>  }</span>
<span id="cb29-27"><a href="#cb29-27"></a>  pwr1[i]=<span class="kw">mean</span>(number1)</span>
<span id="cb29-28"><a href="#cb29-28"></a>  pwr2[i]=<span class="kw">mean</span>(number2)</span>
<span id="cb29-29"><a href="#cb29-29"></a>}</span>
<span id="cb29-30"><a href="#cb29-30"></a><span class="kw">print</span>(<span class="kw">cbind</span>(pwr1,pwr2))</span></code></pre></div>
<pre><code>##       pwr1  pwr2
## [1,] 0.102 0.083
## [2,] 0.455 0.542
## [3,] 0.912 1.000</code></pre>
</div>
<div id="exercises-6.c" class="section level2">
<h2>Exercises 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness β 1,d is deﬁned by Mardia as <span class="math display">\[
\beta_{1,d}=E[(X-u)^T \Sigma^{-1}(Y-u)]^3
\]</span></p>
<p>Under normality, <span class="math inline">\(\beta_{1,d}= 0\)</span>. The multivariate skewness statistic is <span class="math display">\[
b_{1,d}=\frac{1}{n^2} \sum_{i,j=1}^n ((X_i-\bar{X})^T \hat{\Sigma}^{-1}(Y_j-\bar{X}))^3
\]</span></p>
<p>where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of b 1,d are signiﬁcant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="solve.-8" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb31-2"><a href="#cb31-2"></a>Mardia&lt;-<span class="cf">function</span>(mydata){</span>
<span id="cb31-3"><a href="#cb31-3"></a>  n=<span class="kw">nrow</span>(mydata)</span>
<span id="cb31-4"><a href="#cb31-4"></a>  c=<span class="kw">ncol</span>(mydata)</span>
<span id="cb31-5"><a href="#cb31-5"></a>  central&lt;-mydata</span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</span>
<span id="cb31-7"><a href="#cb31-7"></a>    central[,i]&lt;-mydata[,i]<span class="op">-</span><span class="kw">mean</span>(mydata[,i])</span>
<span id="cb31-8"><a href="#cb31-8"></a>  }</span>
<span id="cb31-9"><a href="#cb31-9"></a>  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</span>
<span id="cb31-10"><a href="#cb31-10"></a>  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</span>
<span id="cb31-11"><a href="#cb31-11"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</span>
<span id="cb31-12"><a href="#cb31-12"></a>  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</span>
<span id="cb31-15"><a href="#cb31-15"></a>}</span>
<span id="cb31-16"><a href="#cb31-16"></a></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb31-18"><a href="#cb31-18"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb31-19"><a href="#cb31-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb31-20"><a href="#cb31-20"></a>m=<span class="dv">1000</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb31-22"><a href="#cb31-22"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb31-23"><a href="#cb31-23"></a>a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb31-25"><a href="#cb31-25"></a>  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb31-26"><a href="#cb31-26"></a>    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb31-27"><a href="#cb31-27"></a>    <span class="kw">Mardia</span>(mydata)</span>
<span id="cb31-28"><a href="#cb31-28"></a>  }))</span>
<span id="cb31-29"><a href="#cb31-29"></a>}</span>
<span id="cb31-30"><a href="#cb31-30"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.001 0.017 0.036 0.049 0.046 0.054</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw">set.seed</span>(<span class="dv">7912</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="kw">set.seed</span>(<span class="dv">7912</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb33-7"><a href="#cb33-7"></a>sigma=<span class="kw">list</span>(sigma1,sigma2)</span>
<span id="cb33-8"><a href="#cb33-8"></a>m=<span class="dv">1000</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>n=<span class="dv">50</span></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb33-12"><a href="#cb33-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb33-13"><a href="#cb33-13"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb33-16"><a href="#cb33-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-17"><a href="#cb33-17"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb33-19"><a href="#cb33-19"></a>    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb33-21"><a href="#cb33-21"></a>      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </span>
<span id="cb33-22"><a href="#cb33-22"></a>      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</span>
<span id="cb33-23"><a href="#cb33-23"></a>    }</span>
<span id="cb33-24"><a href="#cb33-24"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</span>
<span id="cb33-25"><a href="#cb33-25"></a>  }</span>
<span id="cb33-26"><a href="#cb33-26"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb33-27"><a href="#cb33-27"></a>}</span>
<span id="cb33-28"><a href="#cb33-28"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb33-29"><a href="#cb33-29"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb33-30"><a href="#cb33-30"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb33-31"><a href="#cb33-31"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb33-32"><a href="#cb33-32"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb33-33"><a href="#cb33-33"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?<br />
(1)What is the corresponding hypothesis test problem?<br />
(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?<br />
(3)What information is needed to test your hypothesis?</p>
</div>
<div id="solve" class="section level2">
<h2>Solve</h2>
<div id="section" class="section level3">
<h3>(1)</h3>
<p>Null hypothesis <span class="math inline">\(H_0:power1=power2\)</span> . alternative hypothesis <span class="math inline">\(H_1:power1 \neq power2\)</span></p>
</div>
<div id="section-1" class="section level3">
<h3>(2)</h3>
<p>(a)Z-test: Assume <span class="math inline">\(x_i=power1(i),y_i=power2(i),z_i=x_i-y_i\)</span>,Test whether the mean of <span class="math inline">\(z_i\)</span> is 0. two-sample t-test.</p>
<p>(b)The sample data of the two-sample t-test is required to come from two independent populations, which is not related. But both power1 and power2 are generated in the same population, so the two-sample t test cannot be used.</p>
<p>(c)The paired-sample t-test is a special case of the one-sample t-test. There are many cases of paired t-test: two subjects who are paired receive two different treatments respectively; the same subject receives two different treatments; the results of the same subject before and after treatment are compared (ie self-pairing).</p>
<p>(d)The McNemar test uses two methods to test the same sample, and compares the differences between the two methods, using the paired chi-square test.</p>
</div>
<div id="section-2" class="section level3">
<h3>(3)</h3>
<p>A large enough sample, power1 and power2 calculated by two methods</p>
</div>
</div>
</div>
<div id="hw-2020-11-03" class="section level1">
<h1>HW-2020-11-03</h1>
<div id="exercises-7.1" class="section level2">
<h2>Exercises 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="solve.-9" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">data</span>(law,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>n=<span class="kw">nrow</span>(law)</span>
<span id="cb34-3"><a href="#cb34-3"></a>x=law<span class="op">$</span>LSAT</span>
<span id="cb34-4"><a href="#cb34-4"></a>y=law<span class="op">$</span>GPA</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a>theta.hat=<span class="kw">cor</span>(x,y)</span>
<span id="cb34-7"><a href="#cb34-7"></a>theta.jack=<span class="kw">numeric</span>(n)</span>
<span id="cb34-8"><a href="#cb34-8"></a></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb34-10"><a href="#cb34-10"></a>  theta.jack[i]=<span class="kw">cor</span>(x[<span class="op">-</span>i],y[<span class="op">-</span>i])</span>
<span id="cb34-11"><a href="#cb34-11"></a>}</span>
<span id="cb34-12"><a href="#cb34-12"></a>bias.jack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb34-13"><a href="#cb34-13"></a>se.jack=(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta.jack)<span class="op">/</span>n)</span>
<span id="cb34-14"><a href="#cb34-14"></a></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">9</span>)</span></code></pre></div>
<pre><code>##    bias.jack      se.jack 
## -0.006473623  0.142518619</code></pre>
<p>So the jackknife estimate of the bias is -0.006473623 and the standard error of the correlation statistic is 0.142518619 in Example 7.2.</p>
</div>
<div id="exercises-7.5" class="section level2">
<h2>Exercises 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap conﬁdence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may dffer.</p>
</div>
<div id="solve.-10" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">data</span>(aircondit,<span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a>B=<span class="dv">600</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>n=<span class="kw">nrow</span>(aircondit)</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#Bootstrap</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>func=<span class="cf">function</span>(dat,index){</span>
<span id="cb36-7"><a href="#cb36-7"></a>  x=dat[index,]</span>
<span id="cb36-8"><a href="#cb36-8"></a>  theta=<span class="kw">mean</span>(x)</span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="kw">return</span>(theta)</span>
<span id="cb36-10"><a href="#cb36-10"></a>}</span>
<span id="cb36-11"><a href="#cb36-11"></a>bootstrap_result=<span class="kw">boot</span>(<span class="dt">data=</span>aircondit,<span class="dt">statistic=</span>func,<span class="dt">R=</span>B)</span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="kw">boot.ci</span>(bootstrap_result,<span class="dt">conf=</span><span class="fl">0.95</span>,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 600 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_result, conf = 0.95, type = c(&quot;norm&quot;, 
##     &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.9, 179.2 )   ( 23.6, 169.6 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.6, 192.6 )   ( 56.8, 218.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>Because the calculation methods of the four intervals are different, the calculated intervals are also different.</p>
</div>
<div id="exercises-7.8" class="section level2">
<h2>Exercises 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="solve.-11" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">##bootstrap</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>lambda_hat=<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb38-5"><a href="#cb38-5"></a>theta_hat=lambda_hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb38-6"><a href="#cb38-6"></a>B=<span class="dv">200</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>n=<span class="kw">nrow</span>(scor)</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="co">##Jackknif</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>theta_j=<span class="kw">vector</span>()</span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb38-12"><a href="#cb38-12"></a>  x2=scor[<span class="op">-</span>i,]</span>
<span id="cb38-13"><a href="#cb38-13"></a>  lambda=<span class="kw">eigen</span>(<span class="kw">cov</span>(x2))<span class="op">$</span>values</span>
<span id="cb38-14"><a href="#cb38-14"></a>  theta_j[i]=lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb38-15"><a href="#cb38-15"></a>}</span>
<span id="cb38-16"><a href="#cb38-16"></a>bias_j=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_j)<span class="op">-</span>theta_hat)</span>
<span id="cb38-17"><a href="#cb38-17"></a>se_j=<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta_j<span class="op">-</span><span class="kw">mean</span>(theta_j))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_j=</span>bias_j,<span class="dt">se_j=</span>se_j),<span class="dv">9</span>)</span></code></pre></div>
<pre><code>##      bias_j        se_j 
## 0.001069139 0.049552307</code></pre>
<p>the jackknife estimates of bias is 0.001069139 and standard error of <span class="math inline">\(\hat{\theta}\)</span> is 0.049552307 .</p>
</div>
<div id="exercises-7.11" class="section level2">
<h2>Exercises 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="solve-1" class="section level2">
<h2>Solve</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">library</span>(DAAG);<span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">data</span>(<span class="st">&quot;ironslag&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb46-2"><a href="#cb46-2"></a>n =<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a>e11=e22=e33=e44=<span class="kw">matrix</span>(<span class="dv">0</span>,n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>j=<span class="dv">0</span>;</span>
<span id="cb46-8"><a href="#cb46-8"></a></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> k<span class="op">+</span><span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb46-11"><a href="#cb46-11"></a>    <span class="cf">if</span>(i<span class="op">&gt;</span>n)<span class="cf">break</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>    j=j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>    y=magnetic[<span class="op">-</span>k][<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb46-14"><a href="#cb46-14"></a>    x=chemical[<span class="op">-</span>k][<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb46-15"><a href="#cb46-15"></a>    </span>
<span id="cb46-16"><a href="#cb46-16"></a>    J1=<span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb46-17"><a href="#cb46-17"></a>    yhat11=J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</span>
<span id="cb46-18"><a href="#cb46-18"></a>    yhat12=J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]</span>
<span id="cb46-19"><a href="#cb46-19"></a>    e11[j,<span class="dv">1</span>]=magnetic[k]<span class="op">-</span>yhat11</span>
<span id="cb46-20"><a href="#cb46-20"></a>    e11[j,<span class="dv">2</span>]=magnetic[i]<span class="op">-</span>yhat12</span>
<span id="cb46-21"><a href="#cb46-21"></a>    </span>
<span id="cb46-22"><a href="#cb46-22"></a>    J2=<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb46-23"><a href="#cb46-23"></a>    yhat21=J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb46-24"><a href="#cb46-24"></a>    yhat22=J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb46-25"><a href="#cb46-25"></a>    e22[j,<span class="dv">1</span>]=magnetic[k]<span class="op">-</span>yhat21</span>
<span id="cb46-26"><a href="#cb46-26"></a>    e22[j,<span class="dv">2</span>]=magnetic[i]<span class="op">-</span>yhat22</span>
<span id="cb46-27"><a href="#cb46-27"></a>    </span>
<span id="cb46-28"><a href="#cb46-28"></a>    J3=<span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</span>
<span id="cb46-29"><a href="#cb46-29"></a>    logyhat31=J3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>(chemical[k])</span>
<span id="cb46-30"><a href="#cb46-30"></a>    logyhat32=J3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>(chemical[i])</span>
<span id="cb46-31"><a href="#cb46-31"></a>    yhat31=<span class="kw">exp</span>(logyhat31)</span>
<span id="cb46-32"><a href="#cb46-32"></a>    yhat32=<span class="kw">exp</span>(logyhat32)</span>
<span id="cb46-33"><a href="#cb46-33"></a>    e33[j,<span class="dv">1</span>]=magnetic[k]<span class="op">-</span>yhat31</span>
<span id="cb46-34"><a href="#cb46-34"></a>    e33[j,<span class="dv">2</span>]=magnetic[i]<span class="op">-</span>yhat32</span>
<span id="cb46-35"><a href="#cb46-35"></a>    </span>
<span id="cb46-36"><a href="#cb46-36"></a>    J4=<span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</span>
<span id="cb46-37"><a href="#cb46-37"></a>    logyhat41=J4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(chemical[k])</span>
<span id="cb46-38"><a href="#cb46-38"></a>    logyhat42=J4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(chemical[i])</span>
<span id="cb46-39"><a href="#cb46-39"></a>    yhat41=<span class="kw">exp</span>(logyhat41)</span>
<span id="cb46-40"><a href="#cb46-40"></a>    yhat42=<span class="kw">exp</span>(logyhat42)</span>
<span id="cb46-41"><a href="#cb46-41"></a>    e44[j,<span class="dv">1</span>]=magnetic[k]<span class="op">-</span>yhat41</span>
<span id="cb46-42"><a href="#cb46-42"></a>    e44[j,<span class="dv">2</span>]=magnetic[i]<span class="op">-</span>yhat42</span>
<span id="cb46-43"><a href="#cb46-43"></a>  }</span>
<span id="cb46-44"><a href="#cb46-44"></a>}</span>
<span id="cb46-45"><a href="#cb46-45"></a><span class="kw">c</span>(<span class="kw">mean</span>(e11<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e22<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e33<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e44<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>The fitted regression equation for model 2 is <span class="math inline">\(\hat{Y}=24.49262-1.39334 X+ 0.05452 X^2\)</span></p>
</div>
</div>
<div id="hw-2020-11-10" class="section level1">
<h1>HW-2020-11-10</h1>
<div id="exercises-8.3" class="section level2">
<h2>Exercises 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="solve.-12" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>n1 =<span class="st"> </span><span class="dv">20</span>;n2 =<span class="st"> </span><span class="dv">30</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>mu1 =<span class="st"> </span>mu2 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>sigma1 =<span class="st"> </span>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>m =<span class="st"> </span><span class="dv">1000</span>;</span>
<span id="cb50-6"><a href="#cb50-6"></a>alphahat1=alphahat2=<span class="kw">numeric</span>(m)</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a>count5test =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb50-9"><a href="#cb50-9"></a>  X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb50-10"><a href="#cb50-10"></a>  Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb50-11"><a href="#cb50-11"></a>  outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb50-12"><a href="#cb50-12"></a>  outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb50-13"><a href="#cb50-13"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb50-14"><a href="#cb50-14"></a>}</span>
<span id="cb50-15"><a href="#cb50-15"></a></span>
<span id="cb50-16"><a href="#cb50-16"></a>count5test_permutation =<span class="st"> </span><span class="cf">function</span>(z) {</span>
<span id="cb50-17"><a href="#cb50-17"></a>  n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb50-18"><a href="#cb50-18"></a>  x =<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb50-19"><a href="#cb50-19"></a>  y =<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))]</span>
<span id="cb50-20"><a href="#cb50-20"></a>  X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb50-21"><a href="#cb50-21"></a>  Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb50-22"><a href="#cb50-22"></a>  outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </span>
<span id="cb50-23"><a href="#cb50-23"></a>  outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb50-24"><a href="#cb50-24"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb50-25"><a href="#cb50-25"></a>}</span>
<span id="cb50-26"><a href="#cb50-26"></a></span>
<span id="cb50-27"><a href="#cb50-27"></a>permutation =<span class="st"> </span><span class="cf">function</span>(z,R) {</span>
<span id="cb50-28"><a href="#cb50-28"></a>  n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb50-29"><a href="#cb50-29"></a>  out =<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb50-30"><a href="#cb50-30"></a>  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>R){</span>
<span id="cb50-31"><a href="#cb50-31"></a>    p =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n ,n ,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb50-32"><a href="#cb50-32"></a>    out[r] =<span class="st"> </span><span class="kw">count5test_permutation</span>(z[p])</span>
<span id="cb50-33"><a href="#cb50-33"></a>  }</span>
<span id="cb50-34"><a href="#cb50-34"></a>  <span class="kw">sum</span>(out)<span class="op">/</span>R</span>
<span id="cb50-35"><a href="#cb50-35"></a>}              </span>
<span id="cb50-36"><a href="#cb50-36"></a></span>
<span id="cb50-37"><a href="#cb50-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb50-38"><a href="#cb50-38"></a>  x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb50-39"><a href="#cb50-39"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb50-40"><a href="#cb50-40"></a>  x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </span>
<span id="cb50-41"><a href="#cb50-41"></a>  y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb50-42"><a href="#cb50-42"></a>  z =<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb50-43"><a href="#cb50-43"></a>  alphahat1[i]=<span class="kw">count5test</span>(x, y)</span>
<span id="cb50-44"><a href="#cb50-44"></a>  alphahat2[i]=<span class="kw">permutation</span>(z,<span class="dv">1000</span>)</span>
<span id="cb50-45"><a href="#cb50-45"></a>}</span>
<span id="cb50-46"><a href="#cb50-46"></a></span>
<span id="cb50-47"><a href="#cb50-47"></a>alphahat11=<span class="kw">mean</span>(alphahat1)</span>
<span id="cb50-48"><a href="#cb50-48"></a>alphahat22=<span class="kw">mean</span>(alphahat2)</span>
<span id="cb50-49"><a href="#cb50-49"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">count5test=</span>alphahat11,<span class="dt">count5test_permutation=</span>alphahat22),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##             count5test count5test_permutation 
##               0.090000               0.062089</code></pre>
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
</div>
<div id="solve.-13" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">library</span>(energy)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">library</span>(Ball)</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="kw">library</span>(RANN)</span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="kw">library</span>(boot)</span>
<span id="cb52-5"><a href="#cb52-5"></a></span>
<span id="cb52-6"><a href="#cb52-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb52-7"><a href="#cb52-7"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb52-9"><a href="#cb52-9"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb52-10"><a href="#cb52-10"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)  </span>
<span id="cb52-11"><a href="#cb52-11"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb52-12"><a href="#cb52-12"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb52-13"><a href="#cb52-13"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb52-14"><a href="#cb52-14"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb52-15"><a href="#cb52-15"></a>}</span>
<span id="cb52-16"><a href="#cb52-16"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb52-17"><a href="#cb52-17"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb52-18"><a href="#cb52-18"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb52-19"><a href="#cb52-19"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb52-20"><a href="#cb52-20"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb52-21"><a href="#cb52-21"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb52-22"><a href="#cb52-22"></a>}</span>
<span id="cb52-23"><a href="#cb52-23"></a></span>
<span id="cb52-24"><a href="#cb52-24"></a></span>
<span id="cb52-25"><a href="#cb52-25"></a><span class="co"># 1.Unequal variances and equal expectations</span></span>
<span id="cb52-26"><a href="#cb52-26"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb52-27"><a href="#cb52-27"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb52-28"><a href="#cb52-28"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb52-29"><a href="#cb52-29"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb52-30"><a href="#cb52-30"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb52-31"><a href="#cb52-31"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb52-32"><a href="#cb52-32"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb52-33"><a href="#cb52-33"></a>k=<span class="dv">3</span></span>
<span id="cb52-34"><a href="#cb52-34"></a>R=<span class="dv">999</span></span>
<span id="cb52-35"><a href="#cb52-35"></a>m=<span class="dv">100</span></span>
<span id="cb52-36"><a href="#cb52-36"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb52-37"><a href="#cb52-37"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb52-38"><a href="#cb52-38"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb52-39"><a href="#cb52-39"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb52-40"><a href="#cb52-40"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb52-41"><a href="#cb52-41"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb52-42"><a href="#cb52-42"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb52-43"><a href="#cb52-43"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb52-44"><a href="#cb52-44"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb52-45"><a href="#cb52-45"></a>}</span>
<span id="cb52-46"><a href="#cb52-46"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb52-47"><a href="#cb52-47"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb52-48"><a href="#cb52-48"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.35 0.28 0.88</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># 2. Unequal variances and unequal expectations</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb54-4"><a href="#cb54-4"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb54-5"><a href="#cb54-5"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb54-7"><a href="#cb54-7"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb54-8"><a href="#cb54-8"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb54-9"><a href="#cb54-9"></a>k=<span class="dv">3</span></span>
<span id="cb54-10"><a href="#cb54-10"></a>R=<span class="dv">999</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>m=<span class="dv">100</span></span>
<span id="cb54-12"><a href="#cb54-12"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb54-13"><a href="#cb54-13"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb54-14"><a href="#cb54-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb54-15"><a href="#cb54-15"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb54-16"><a href="#cb54-16"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb54-17"><a href="#cb54-17"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb54-18"><a href="#cb54-18"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb54-19"><a href="#cb54-19"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb54-20"><a href="#cb54-20"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb54-21"><a href="#cb54-21"></a>}</span>
<span id="cb54-22"><a href="#cb54-22"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb54-23"><a href="#cb54-23"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb54-24"><a href="#cb54-24"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.33 0.58 0.76</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># 3.Non-normal distributions</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb56-3"><a href="#cb56-3"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb56-4"><a href="#cb56-4"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb56-5"><a href="#cb56-5"></a>k=<span class="dv">3</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>R=<span class="dv">999</span></span>
<span id="cb56-7"><a href="#cb56-7"></a>m=<span class="dv">100</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb56-9"><a href="#cb56-9"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb56-11"><a href="#cb56-11"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb56-12"><a href="#cb56-12"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb56-13"><a href="#cb56-13"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb56-14"><a href="#cb56-14"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb56-15"><a href="#cb56-15"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb56-16"><a href="#cb56-16"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb56-17"><a href="#cb56-17"></a>}</span>
<span id="cb56-18"><a href="#cb56-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb56-19"><a href="#cb56-19"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb56-20"><a href="#cb56-20"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.66 0.57 0.79</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb58-3"><a href="#cb58-3"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb58-4"><a href="#cb58-4"></a>k=<span class="dv">3</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>R=<span class="dv">999</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>m=<span class="dv">100</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb58-8"><a href="#cb58-8"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb58-9"><a href="#cb58-9"></a>rbimodel&lt;-<span class="cf">function</span>(n,mu1,mu2,sd1,sd2){</span>
<span id="cb58-10"><a href="#cb58-10"></a>  index=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb58-11"><a href="#cb58-11"></a>  x=<span class="kw">numeric</span>(n)</span>
<span id="cb58-12"><a href="#cb58-12"></a>  index1&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb58-13"><a href="#cb58-13"></a>  x[index1]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index1), mu1, sd1)</span>
<span id="cb58-14"><a href="#cb58-14"></a>  index2&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">2</span>)</span>
<span id="cb58-15"><a href="#cb58-15"></a>  x[index2]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index2), mu2, sd2)</span>
<span id="cb58-16"><a href="#cb58-16"></a>  <span class="kw">return</span>(x)</span>
<span id="cb58-17"><a href="#cb58-17"></a>}</span>
<span id="cb58-18"><a href="#cb58-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb58-19"><a href="#cb58-19"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n1,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb58-20"><a href="#cb58-20"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb58-21"><a href="#cb58-21"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb58-22"><a href="#cb58-22"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb58-23"><a href="#cb58-23"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb58-24"><a href="#cb58-24"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb58-25"><a href="#cb58-25"></a>}</span>
<span id="cb58-26"><a href="#cb58-26"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb58-27"><a href="#cb58-27"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb58-28"><a href="#cb58-28"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.47 0.59 0.80</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># 4.Unbalanced samples</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb60-3"><a href="#cb60-3"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-4"><a href="#cb60-4"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-6"><a href="#cb60-6"></a>n1=<span class="dv">10</span></span>
<span id="cb60-7"><a href="#cb60-7"></a>n2=<span class="dv">100</span></span>
<span id="cb60-8"><a href="#cb60-8"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb60-9"><a href="#cb60-9"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb60-10"><a href="#cb60-10"></a>k=<span class="dv">3</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>R=<span class="dv">999</span></span>
<span id="cb60-12"><a href="#cb60-12"></a>m=<span class="dv">100</span></span>
<span id="cb60-13"><a href="#cb60-13"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb60-14"><a href="#cb60-14"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb60-15"><a href="#cb60-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb60-16"><a href="#cb60-16"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb60-17"><a href="#cb60-17"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb60-18"><a href="#cb60-18"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb60-19"><a href="#cb60-19"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb60-20"><a href="#cb60-20"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb60-21"><a href="#cb60-21"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb60-22"><a href="#cb60-22"></a>}</span>
<span id="cb60-23"><a href="#cb60-23"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb60-24"><a href="#cb60-24"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb60-25"><a href="#cb60-25"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.10 0.36 0.73</code></pre>
<p>According to the analysis of the results, the results of NN are low, and the results of ball and energy methods are closer.</p>
</div>
</div>
<div id="hw-2020-11-17" class="section level1">
<h1>HW-2020-11-17</h1>
<div id="exercises-9.3" class="section level2">
<h2>Exercises 9.3</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when diﬀerent variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="solve.-14" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb62-6"><a href="#cb62-6"></a>  x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb62-7"><a href="#cb62-7"></a>  x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb62-8"><a href="#cb62-8"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb62-9"><a href="#cb62-9"></a>  k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb62-10"><a href="#cb62-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb62-11"><a href="#cb62-11"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb62-12"><a href="#cb62-12"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb62-13"><a href="#cb62-13"></a>    <span class="cf">else</span> {</span>
<span id="cb62-14"><a href="#cb62-14"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb62-15"><a href="#cb62-15"></a>      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb62-16"><a href="#cb62-16"></a>    }</span>
<span id="cb62-17"><a href="#cb62-17"></a>  }</span>
<span id="cb62-18"><a href="#cb62-18"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb62-19"><a href="#cb62-19"></a>}</span>
<span id="cb62-20"><a href="#cb62-20"></a></span>
<span id="cb62-21"><a href="#cb62-21"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb62-22"><a href="#cb62-22"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb62-23"><a href="#cb62-23"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb62-24"><a href="#cb62-24"></a>rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb62-25"><a href="#cb62-25"></a>rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb62-26"><a href="#cb62-26"></a>rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb62-27"><a href="#cb62-27"></a>rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb62-28"><a href="#cb62-28"></a></span>
<span id="cb62-29"><a href="#cb62-29"></a><span class="co">#plot</span></span>
<span id="cb62-30"><a href="#cb62-30"></a><span class="co"># par(mfrow=c(2,2))  #display 4 graphs together</span></span>
<span id="cb62-31"><a href="#cb62-31"></a>rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb62-32"><a href="#cb62-32"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb62-33"><a href="#cb62-33"></a>  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb62-34"><a href="#cb62-34"></a>       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb62-35"><a href="#cb62-35"></a>       <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb62-36"><a href="#cb62-36"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8ZM4qDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHfUlEQVR4nO2da2PbJhhGaZt0l2Rb18Tb6s1O+P9/crJ1MZKAgxwkYfk5H1LHfnkFxwiQTVRjRRSzdgVKR4IACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgILMgczOsJShvuvmQIECCgJUFle9JggAJAtYWVLwhCQIkCJAgQIIACQIWFjS4BpxwLbgW6kGABAESBKx9NS9BkE6CIJ0EQToJgnQSBOkkCNJJEKSTIEgnQZBOgiCdBA2yjL7yLt3Q2j1IgiidBEE6CYJ0EgTpJAjSSRCku0tBb89P1c9Dtdr5/IPS3a+g/Zf/To++Q7q7FdSoOWuKpbtbQcfHs6BD4CSTIPWgCG/Pp8vRB9sO17F0dynInh19eq0msoAfCUpOJ0H9LPo8aGo6CYJ0dymonsVqtA7y8f4SvAgbprtPQZWhh8R0dyqoWgEFrlKH6TYs6G84i9LSbUzQ27f29+MjDTNpx92aoOfqAuLELvxZ2LTjbkxQNfqeLkKPjwYG4eTjbk3Qafj99Idp+lGG425PUNOJch13e4L2px70sQHIblhQdRXxcP4Z+qBn6nE3Juijs9jmP+7QOmhCoFbS1wVOTCdBkK70P4iSIECCAAkCJAiQIGB1QaXP8xIESBAw2/6g1D2K9ysocY/iLIIy5pxNUOoOs0mJTWL0LQjy71H03AF0eUGT9G2yB8Haavhq9CY9MwlK36M4SExN24YgO2GPYj+xr6rGfZhXkGnCVxCUno4EmWsFBUNNL9A4guJvDxw0NXBquhRBpnsYfrNdj1sT1K/xMDImyPgfmmBnMzYkqP+KL22cFQS1I0T3bPfQ9EKcBnZFvIKa4s4nCabO2b4JhQsy6YJaG6ZZWtmAoP6ZnCJoKHZ9QecqtTUzXTXtJEHm8lQX5xFUm3B8NkUHgq5ax84oqG3PSFAzQnStNW1TOiVN87oMjiATFWQuCV3BbW2KFORWtVWTLMj0BV1CL0dxBZmQIKdLTWz33IJ6Vb00t3vJ+gQZFuR0jIugXkK3B5YqyEM3MrjN717wCRo33BnYukjrGh0Jcg89sd1rCfK/yRHssNAgT6R87y1o54hlBfXaERXkbVCKIDM6aUf5MIVTxWJ7kF/QMDpYePiCdf/1lPI9VZSg0Ilmu4HGnXncKc/TVE8nccf1WxTUP/mcpiYJ6v0aFmTHgtwpc6BparvnFFT/dNrRzvHtWnkgqDdPOa13BfUNNYd04jtfraD+qrOsWaz5GRTUNL6Jdld0tvvXdpcWxl1WdqvMgSDbpbkI6gqVKqhdPfeuojpHg5KOIOteuoUF2bY7duZ9glrHnoomtygHoxZHBPnCXVFjQdZ2nawnyI4FXfpkW6p/vAIENU9EBXlKuj58gi7D1bh87wwyboQZHrAcQfWP6YJGQVMFDSKWEDTpu3n3CXN5HDxe0FwX0BfkC4wJoop+ONBO/G7efcIEXpxUkaGgWIjnt6mHmxxoJ36z6nk2lyAO4ZSzCUq9f1DeF88BXNUSBF3Vg7JUJEVQesqZBJ1O/8Tv5qfCgibnWFyQDX43P7oWnIHbELRwuo+xlqD3l/CfJRYlKIYEARIESBCwmqCbYUZB+ZImxq0SdmV43qQSlCdOgkoMuzI8b1IJyhMnQSWGXRmeN6kE5YnbnqAtIUGABAESBEgQIEGABAESBEgQIEGABAESBEgQkF/QwcRuS33ZIdLFxQvEOP70I3fKEdkFHU67P8K1O359HcRBgQhvz+dtXDlTjsktqP5WcRe8dXe7Na2LowJhDs1m0owpPeQWVG/R2we3we4fBnFUIMjBPNVq8qX0kV3Qub+HtjBW7+vP1Xjx5MRRgRh1qawpR+QWVJ/6wQHg7fm0uXH3dImDAvGDnRzkTTliYUFN0Ocf+QTlTTli6VOsDnr8nvEUy5pyxNKDdB309TXLiOoKypRyxMLTfF33qmFZ5uSzoLwpRyy9UDxXuxpRs6zqmlksZ8oR+S819ia6zN9Vc/L3XhwUiNCcYjlTjtDFKiBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBNyXo/aXebLcktyTo/eXTq92bPNtaUrklQVk3RqVyS4Jqcm38SaRAQe9/PZ7vERUYbHZ334N2X/6xx2/+W6HayH9AOQ/lCWr2qP5a/7ZrbjnWjsyHhcfoAgXV++refvOONEv3n4IFeW/pvV/cT4GCajXNfav7p9jeBG6EPiPlCarm8T+rNaHnhtXHx8X7T5GC7L+/G/OLZxbb153p7tdBZSFBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgT8D45CRrabLLAdAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>Rej =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</span>
<span id="cb63-3"><a href="#cb63-3"></a>Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma)</span>
<span id="cb63-6"><a href="#cb63-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sigma= 0.05</th>
<th align="right">sigma= 0.5</th>
<th align="right">sigma= 2</th>
<th align="right">sigma= 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accept rates</td>
<td align="right">0.977</td>
<td align="right">0.8325</td>
<td align="right">0.534</td>
<td align="right">0.107</td>
</tr>
</tbody>
</table>
</div>
<div id="exercises-1" class="section level2">
<h2>Exercises</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt; 1.2\)</span>.</p>
</div>
<div id="solve.-15" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">library</span>(GeneralizedHyperbolic)</span>
<span id="cb64-3"><a href="#cb64-3"></a>Gelman.Rubin =<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  psi =<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb64-7"><a href="#cb64-7"></a>  n =<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb64-8"><a href="#cb64-8"></a>  k =<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb64-9"><a href="#cb64-9"></a>  psi.means =<span class="st"> </span><span class="kw">rowMeans</span>(psi)        <span class="co">#row means</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>  B =<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)           <span class="co">#between variance est.</span></span>
<span id="cb64-11"><a href="#cb64-11"></a>  psi.w =<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)     <span class="co">#within variances</span></span>
<span id="cb64-12"><a href="#cb64-12"></a>  W =<span class="st"> </span><span class="kw">mean</span>(psi.w)                  <span class="co">#within est.</span></span>
<span id="cb64-13"><a href="#cb64-13"></a>  v.hat =<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)        <span class="co">#upper variance est.</span></span>
<span id="cb64-14"><a href="#cb64-14"></a>  r.hat =<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W                <span class="co">#G-R statistic</span></span>
<span id="cb64-15"><a href="#cb64-15"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb64-16"><a href="#cb64-16"></a>}</span>
<span id="cb64-17"><a href="#cb64-17"></a></span>
<span id="cb64-18"><a href="#cb64-18"></a>laplace.chain =<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb64-19"><a href="#cb64-19"></a>  <span class="co">#generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb64-21"><a href="#cb64-21"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>  x =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb64-23"><a href="#cb64-23"></a>  x[<span class="dv">1</span>] =<span class="st"> </span>X1</span>
<span id="cb64-24"><a href="#cb64-24"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb64-25"><a href="#cb64-25"></a>  param =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb64-26"><a href="#cb64-26"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb64-27"><a href="#cb64-27"></a>    xt =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb64-28"><a href="#cb64-28"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb64-29"><a href="#cb64-29"></a>    r1 =<span class="st"> </span><span class="kw">dskewlap</span>(y, <span class="dt">param =</span> param) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb64-30"><a href="#cb64-30"></a>    r2 =<span class="st"> </span><span class="kw">dskewlap</span>(xt, <span class="dt">param =</span> param) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb64-31"><a href="#cb64-31"></a>    r =<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb64-32"><a href="#cb64-32"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) x[i] =<span class="st"> </span>y <span class="cf">else</span></span>
<span id="cb64-33"><a href="#cb64-33"></a>      x[i] =<span class="st"> </span>xt</span>
<span id="cb64-34"><a href="#cb64-34"></a>  }</span>
<span id="cb64-35"><a href="#cb64-35"></a>  <span class="kw">return</span>(x)</span>
<span id="cb64-36"><a href="#cb64-36"></a>}</span>
<span id="cb64-37"><a href="#cb64-37"></a>sigma =<span class="dv">1</span>            <span class="co">#parameter of proposal distribution</span></span>
<span id="cb64-38"><a href="#cb64-38"></a>k =<span class="st"> </span><span class="dv">4</span>               <span class="co">#number of chains to generate</span></span>
<span id="cb64-39"><a href="#cb64-39"></a>n =<span class="st"> </span><span class="dv">15000</span>           <span class="co">#length of chains</span></span>
<span id="cb64-40"><a href="#cb64-40"></a>b =<span class="st"> </span><span class="dv">1000</span>            <span class="co">#burn-in length</span></span>
<span id="cb64-41"><a href="#cb64-41"></a></span>
<span id="cb64-42"><a href="#cb64-42"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb64-43"><a href="#cb64-43"></a>x0 =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb64-44"><a href="#cb64-44"></a></span>
<span id="cb64-45"><a href="#cb64-45"></a><span class="co">#generate the chains</span></span>
<span id="cb64-46"><a href="#cb64-46"></a>X =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb64-47"><a href="#cb64-47"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb64-48"><a href="#cb64-48"></a>  X[i, ] =<span class="st"> </span><span class="kw">laplace.chain</span>(sigma, n, x0[i])</span>
<span id="cb64-49"><a href="#cb64-49"></a></span>
<span id="cb64-50"><a href="#cb64-50"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb64-51"><a href="#cb64-51"></a>psi =<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb64-52"><a href="#cb64-52"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)){</span>
<span id="cb64-53"><a href="#cb64-53"></a>  psi[i,] =<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb64-54"><a href="#cb64-54"></a>}</span>
<span id="cb64-55"><a href="#cb64-55"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.0112</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb66-5"><a href="#cb66-5"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>rhat =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){rhat[j] =<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])}</span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-11.4" class="section level2">
<h2>Exercises 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}) \\
S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})
\]</span> for <span class="math inline">\(k = 4 , 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with k degrees of freedom.</p>
</div>
<div id="solve.-16" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>k=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a></span>
<span id="cb68-3"><a href="#cb68-3"></a>S =<span class="st"> </span><span class="cf">function</span>(a,k){</span>
<span id="cb68-4"><a href="#cb68-4"></a>  ck =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="kw">pt</span>(ck,<span class="dt">df=</span>k,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb68-6"><a href="#cb68-6"></a>}</span>
<span id="cb68-7"><a href="#cb68-7"></a></span>
<span id="cb68-8"><a href="#cb68-8"></a>solve =<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb68-9"><a href="#cb68-9"></a>  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</span>
<span id="cb68-10"><a href="#cb68-10"></a>  output<span class="op">$</span>root</span>
<span id="cb68-11"><a href="#cb68-11"></a>}</span>
<span id="cb68-12"><a href="#cb68-12"></a></span>
<span id="cb68-13"><a href="#cb68-13"></a>root =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</span>
<span id="cb68-14"><a href="#cb68-14"></a></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb68-16"><a href="#cb68-16"></a>  root[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve</span>(k[i]),<span class="dv">4</span>)</span>
<span id="cb68-17"><a href="#cb68-17"></a>}</span>
<span id="cb68-18"><a href="#cb68-18"></a></span>
<span id="cb68-19"><a href="#cb68-19"></a>root[<span class="dv">1</span>,] =<span class="st"> </span>k</span>
<span id="cb68-20"><a href="#cb68-20"></a><span class="kw">rownames</span>(root) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>)</span>
<span id="cb68-21"><a href="#cb68-21"></a>root</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]    [,7]    [,8]   [,9]   [,10]
## k    4.0000 5.0000 6.0000 7.0000 8.0000 9.0000 10.0000 11.0000 12.000 13.0000
## A(k) 1.4921 1.5336 1.5627 1.5844 1.6012 1.6145  1.6254  1.6344  1.642  1.6486
##        [,11]   [,12]   [,13]   [,14]   [,15]   [,16]   [,17]   [,18]   [,19]
## k    14.0000 15.0000 16.0000 17.0000 18.0000 19.0000 20.0000 21.0000 22.0000
## A(k)  1.6542  1.6591  1.6635  1.6673  1.6707  1.6738  1.6766  1.6792  1.6815
##        [,20]   [,21]   [,22]    [,23]    [,24]     [,25]
## k    23.0000 24.0000 25.0000 100.0000 500.0000 1000.0000
## A(k)  1.6836  1.6856  1.6874   1.7206   1.7298    1.7309</code></pre>
</div>
</div>
<div id="hw-2020-11-24" class="section level1">
<h1>HW-2020-11-24</h1>
<div id="exercises-2" class="section level2">
<h2>Exercises</h2>
<p>A-B-O blood type problem. <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=444(A-type),n_{B\cdot}=n_{BB}+n_{BO}=132(B-type),n_{OO}=361(O-type),n_{A B}=63(AB-type)\)</span>.</p>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="solve.-17" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">library</span>(nloptr)</span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="co"># Mle </span></span>
<span id="cb70-3"><a href="#cb70-3"></a>eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb70-4"><a href="#cb70-4"></a>  </span>
<span id="cb70-5"><a href="#cb70-5"></a>  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</span>
<span id="cb70-6"><a href="#cb70-6"></a>  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</span>
<span id="cb70-7"><a href="#cb70-7"></a>  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</span>
<span id="cb70-8"><a href="#cb70-8"></a>  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</span>
<span id="cb70-9"><a href="#cb70-9"></a>  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></span>
<span id="cb70-10"><a href="#cb70-10"></a><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</span>
<span id="cb70-11"><a href="#cb70-11"></a>}</span>
<span id="cb70-12"><a href="#cb70-12"></a></span>
<span id="cb70-13"><a href="#cb70-13"></a></span>
<span id="cb70-14"><a href="#cb70-14"></a><span class="co"># constraint</span></span>
<span id="cb70-15"><a href="#cb70-15"></a>eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb70-16"><a href="#cb70-16"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</span>
<span id="cb70-17"><a href="#cb70-17"></a>}</span>
<span id="cb70-18"><a href="#cb70-18"></a></span>
<span id="cb70-19"><a href="#cb70-19"></a>opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,<span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</span>
<span id="cb70-20"><a href="#cb70-20"></a></span>
<span id="cb70-21"><a href="#cb70-21"></a>mle =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb70-22"><a href="#cb70-22"></a>r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb70-23"><a href="#cb70-23"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.25</span>))        <span class="co"># the beginning value of p0 and q0</span></span>
<span id="cb70-24"><a href="#cb70-24"></a>j =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb70-25"><a href="#cb70-25"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</span>
<span id="cb70-26"><a href="#cb70-26"></a>  res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.1</span>),</span>
<span id="cb70-27"><a href="#cb70-27"></a>                <span class="dt">eval_f=</span>eval_f0,</span>
<span id="cb70-28"><a href="#cb70-28"></a>                <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb70-29"><a href="#cb70-29"></a>                <span class="dt">eval_g_ineq =</span> eval_g0, </span>
<span id="cb70-30"><a href="#cb70-30"></a>                <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span> )</span>
<span id="cb70-31"><a href="#cb70-31"></a>  j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb70-32"><a href="#cb70-32"></a>  r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</span>
<span id="cb70-33"><a href="#cb70-33"></a>  mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="op">-</span><span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</span>
<span id="cb70-34"><a href="#cb70-34"></a>}</span>
<span id="cb70-35"><a href="#cb70-35"></a><span class="co">#the result of EM algorithm</span></span>
<span id="cb70-36"><a href="#cb70-36"></a>r=<span class="kw">cbind</span>(r,mle)</span>
<span id="cb70-37"><a href="#cb70-37"></a><span class="kw">colnames</span>(r)=<span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;log_Mle&quot;</span>)</span>
<span id="cb70-38"><a href="#cb70-38"></a>r</span></code></pre></div>
<pre><code>##               p         q   log_Mle
##  [1,] 0.0000000 0.0000000 -1467.009
##  [2,] 0.2500000 0.2500000 -1431.343
##  [3,] 0.2979000 0.1107000 -1428.187
##  [4,] 0.2981639 0.1031484 -1427.792
##  [5,] 0.2977599 0.1027347 -1427.729
##  [6,] 0.2976635 0.1027088 -1427.718
##  [7,] 0.2976449 0.1027066 -1427.716
##  [8,] 0.2976414 0.1027063 -1427.716
##  [9,] 0.2976408 0.1027063 -1427.716
## [10,] 0.2976407 0.1027063 -1427.716
## [11,] 0.2976407 0.1027063 -1427.716
## [12,] 0.2976407 0.1027063 -1427.716
## [13,] 0.2976407 0.1027063 -1467.009
## [14,] 0.2976407 0.1027063 -1431.343</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">#the log_max likelihood values</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw">plot</span>(mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-3-page-204" class="section level2">
<h2>Exercises 3 (page 204)</h2>
<p>Use both for loops and lapply() to ﬁt linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="solve.-18" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb73-2"><a href="#cb73-2"></a></span>
<span id="cb73-3"><a href="#cb73-3"></a>formulas =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb73-4"><a href="#cb73-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb73-5"><a href="#cb73-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb73-6"><a href="#cb73-6"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb73-7"><a href="#cb73-7"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb73-8"><a href="#cb73-8"></a>)</span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="co">#1 for loops</span></span>
<span id="cb73-10"><a href="#cb73-10"></a>f1 =<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb73-11"><a href="#cb73-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb73-12"><a href="#cb73-12"></a>  f1[[i]] =<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</span>
<span id="cb73-13"><a href="#cb73-13"></a>}</span>
<span id="cb73-14"><a href="#cb73-14"></a>f1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co">#2 lapply</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>f2 =<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))</span>
<span id="cb75-3"><a href="#cb75-3"></a>f2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="exercises-3-page-213" class="section level2">
<h2>Exercises 3 (page 213)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
</div>
<div id="solve.-19" class="section level2">
<h2>Solve.</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>trials =<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb77-3"><a href="#cb77-3"></a>  <span class="dv">100</span>,</span>
<span id="cb77-4"><a href="#cb77-4"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb77-5"><a href="#cb77-5"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>)</span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="co"># anonymous function:</span></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</span></code></pre></div>
<pre><code>##   [1] 0.027244088 0.970264651 0.841614412 0.843607534 0.059771356 0.722565615
##   [7] 0.683770819 0.039356387 0.571554185 0.289565805 0.611798048 0.203644404
##  [13] 0.054600483 0.904607967 0.911841272 0.351889669 0.353569835 0.272205552
##  [19] 0.757591119 0.791269351 0.114922202 0.993893302 0.296951195 0.320241743
##  [25] 0.762052132 0.972673027 0.868058892 0.319256648 0.005775194 0.145719710
##  [31] 0.747811983 0.870617757 0.366735265 0.611954997 0.807865913 0.097214871
##  [37] 0.021657065 0.132021699 0.867490265 0.814267631 0.979102573 0.823335779
##  [43] 0.342437781 0.284830597 0.945349534 0.626075852 0.330823784 0.775045162
##  [49] 0.753765324 0.974309768 0.878214260 0.579870246 0.236994834 0.254781526
##  [55] 0.912569430 0.456450307 0.971808406 0.349497761 0.317251742 0.501850909
##  [61] 0.982182468 0.674102099 0.172421678 0.056164440 0.439805001 0.239097048
##  [67] 0.272963057 0.613416546 0.908244699 0.030085567 0.768092643 0.271132464
##  [73] 0.786240282 0.597826382 0.288313418 0.387335398 0.879953357 0.598278028
##  [79] 0.782806088 0.957829375 0.248056399 0.080852294 0.142817718 0.050115673
##  [85] 0.347015979 0.532744893 0.841528996 0.808712238 0.502939014 0.384968428
##  [91] 0.858258529 0.418853293 0.671383188 0.581131788 0.076598832 0.885933508
##  [97] 0.905180521 0.006526158 0.068241877 0.502265782</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co">## extra challenge:</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span> ,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.027244088 0.970264651 0.841614412 0.843607534 0.059771356 0.722565615
##   [7] 0.683770819 0.039356387 0.571554185 0.289565805 0.611798048 0.203644404
##  [13] 0.054600483 0.904607967 0.911841272 0.351889669 0.353569835 0.272205552
##  [19] 0.757591119 0.791269351 0.114922202 0.993893302 0.296951195 0.320241743
##  [25] 0.762052132 0.972673027 0.868058892 0.319256648 0.005775194 0.145719710
##  [31] 0.747811983 0.870617757 0.366735265 0.611954997 0.807865913 0.097214871
##  [37] 0.021657065 0.132021699 0.867490265 0.814267631 0.979102573 0.823335779
##  [43] 0.342437781 0.284830597 0.945349534 0.626075852 0.330823784 0.775045162
##  [49] 0.753765324 0.974309768 0.878214260 0.579870246 0.236994834 0.254781526
##  [55] 0.912569430 0.456450307 0.971808406 0.349497761 0.317251742 0.501850909
##  [61] 0.982182468 0.674102099 0.172421678 0.056164440 0.439805001 0.239097048
##  [67] 0.272963057 0.613416546 0.908244699 0.030085567 0.768092643 0.271132464
##  [73] 0.786240282 0.597826382 0.288313418 0.387335398 0.879953357 0.598278028
##  [79] 0.782806088 0.957829375 0.248056399 0.080852294 0.142817718 0.050115673
##  [85] 0.347015979 0.532744893 0.841528996 0.808712238 0.502939014 0.384968428
##  [91] 0.858258529 0.418853293 0.671383188 0.581131788 0.076598832 0.885933508
##  [97] 0.905180521 0.006526158 0.068241877 0.502265782</code></pre>
</div>
<div id="exercises-6-page-214" class="section level2">
<h2>Exercises 6 (page 214)</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What argu- ments should the function take?</p>
</div>
<div id="solve.-20" class="section level2">
<h2>Solve.</h2>
<p>The function should take arguments: data,funct,output_type</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">attach</span>(mtcars)</span></code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 3):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>lapply1=<span class="cf">function</span>(data,funct,output_type){</span>
<span id="cb83-2"><a href="#cb83-2"></a>  new=<span class="kw">Map</span>(funct,data)</span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="kw">vapply</span>(new,<span class="cf">function</span>(x) x , output_type)</span>
<span id="cb83-4"><a href="#cb83-4"></a>}</span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="co">##   Example</span></span>
<span id="cb83-7"><a href="#cb83-7"></a><span class="kw">lapply1</span>(mtcars,median,<span class="kw">double</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear 
##  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000 
##    carb 
##   2.000</code></pre>
</div>
</div>
<div id="hw-2020-12-01" class="section level1">
<h1>HW-2020-12-01</h1>
<div id="exercises-3" class="section level2">
<h2>Exercises</h2>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).<br />
1. Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.<br />
2. Campare the computation time of the two functions with the function “microbenchmark”.<br />
3. Comments your results.</p>
</div>
<div id="solve.-21" class="section level2">
<h2>Solve.</h2>
<div id="rcpp-code" class="section level3">
<h3>Rcpp code</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb85-1"><a href="#cb85-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</span>
<span id="cb85-4"><a href="#cb85-4"></a></span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="dt">double</span> f(<span class="dt">double</span> x) {</span>
<span id="cb85-7"><a href="#cb85-7"></a>  <span class="cf">return</span> exp(-abs(x));</span>
<span id="cb85-8"><a href="#cb85-8"></a>}</span>
<span id="cb85-9"><a href="#cb85-9"></a></span>
<span id="cb85-10"><a href="#cb85-10"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb85-11"><a href="#cb85-11"></a>NumericVector rwC_Metropolis (<span class="dt">double</span> sigma, <span class="dt">double</span> x0, <span class="dt">int</span> N) {</span>
<span id="cb85-12"><a href="#cb85-12"></a>  NumericVector x(N);</span>
<span id="cb85-13"><a href="#cb85-13"></a>  x[<span class="dv">0</span>] = x0; </span>
<span id="cb85-14"><a href="#cb85-14"></a>  NumericVector u = runif(N);</span>
<span id="cb85-15"><a href="#cb85-15"></a>  <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; N;i++ ) {</span>
<span id="cb85-16"><a href="#cb85-16"></a>    NumericVector y = rnorm(<span class="dv">1</span>, x[i-<span class="dv">1</span>], sigma);</span>
<span id="cb85-17"><a href="#cb85-17"></a>    <span class="cf">if</span> (u[i] &lt;= (f(y[<span class="dv">0</span>]) / f(x[i-<span class="dv">1</span>]))){</span>
<span id="cb85-18"><a href="#cb85-18"></a>      x[i] = y[<span class="dv">0</span>];</span>
<span id="cb85-19"><a href="#cb85-19"></a>    }</span>
<span id="cb85-20"><a href="#cb85-20"></a>    <span class="cf">else</span> { </span>
<span id="cb85-21"><a href="#cb85-21"></a>      x[i] = x[i-<span class="dv">1</span>]; </span>
<span id="cb85-22"><a href="#cb85-22"></a>    }</span>
<span id="cb85-23"><a href="#cb85-23"></a>  }</span>
<span id="cb85-24"><a href="#cb85-24"></a>  <span class="cf">return</span>(x);</span>
<span id="cb85-25"><a href="#cb85-25"></a>} </span></code></pre></div>
</div>
<div id="compare-the-corresponding-generated-random-numbers-with-those-by-the-r-function-you-wrote-before-using-the-function-qqplot." class="section level3">
<h3>1. Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb86-4"><a href="#cb86-4"></a></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="co"># R</span></span>
<span id="cb86-6"><a href="#cb86-6"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb86-7"><a href="#cb86-7"></a></span>
<span id="cb86-8"><a href="#cb86-8"></a>rwR_Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb86-9"><a href="#cb86-9"></a>  x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb86-10"><a href="#cb86-10"></a>  x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb86-11"><a href="#cb86-11"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb86-12"><a href="#cb86-12"></a>  k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb86-13"><a href="#cb86-13"></a></span>
<span id="cb86-14"><a href="#cb86-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb86-15"><a href="#cb86-15"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb86-16"><a href="#cb86-16"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb86-17"><a href="#cb86-17"></a>    <span class="cf">else</span> {</span>
<span id="cb86-18"><a href="#cb86-18"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb86-19"><a href="#cb86-19"></a>      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb86-20"><a href="#cb86-20"></a>      }</span>
<span id="cb86-21"><a href="#cb86-21"></a>    }</span>
<span id="cb86-22"><a href="#cb86-22"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb86-23"><a href="#cb86-23"></a>  }</span>
<span id="cb86-24"><a href="#cb86-24"></a></span>
<span id="cb86-25"><a href="#cb86-25"></a>dir_cpp =<span class="st"> &#39;C:/Users/admin/Desktop/StatComp20068/src/&#39;</span></span>
<span id="cb86-26"><a href="#cb86-26"></a><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;rwC_Metropolis.cpp&quot;</span>))</span>
<span id="cb86-27"><a href="#cb86-27"></a>x0 =<span class="st"> </span><span class="dv">15</span></span>
<span id="cb86-28"><a href="#cb86-28"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb86-29"><a href="#cb86-29"></a>sigma =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb86-30"><a href="#cb86-30"></a>rwR=<span class="kw">rwR_Metropolis</span>(sigma,x0,N)</span>
<span id="cb86-31"><a href="#cb86-31"></a>rwC=<span class="kw">rwC_Metropolis</span>(sigma,x0,N)</span>
<span id="cb86-32"><a href="#cb86-32"></a></span>
<span id="cb86-33"><a href="#cb86-33"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb86-34"><a href="#cb86-34"></a><span class="kw">plot</span>(rwR<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlab =</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">2</span>),<span class="dt">ylab =</span> <span class="st">&quot;rwR&quot;</span>,<span class="dt">ylim =</span> <span class="kw">range</span>(rwR<span class="op">$</span>x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">plot</span>(rwC,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlab =</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">2</span>),<span class="dt">ylab =</span> <span class="st">&quot;rwC&quot;</span>,<span class="dt">ylim =</span> <span class="kw">range</span>(rwC))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="qqplot" class="section level3">
<h3>qqplot</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>rwR =<span class="st"> </span><span class="kw">rwR_Metropolis</span>(sigma,x0,N)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)]</span>
<span id="cb88-3"><a href="#cb88-3"></a>rwC =<span class="st"> </span><span class="kw">rwC_Metropolis</span>(sigma,x0,N)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)]</span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="kw">qqplot</span>(rwR,rwC)</span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="campare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level3">
<h3>2.Campare the computation time of the two functions with the function “microbenchmark”.</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a>(<span class="dt">time =</span> <span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rwR_Metropolis</span>(sigma,x0,N),<span class="dt">rwC=</span><span class="kw">rwC_Metropolis</span>(sigma,x0,N)))</span></code></pre></div>
<pre><code>## Unit: microseconds
##  expr      min       lq      mean   median         uq       max neval
##   rwR 7953.401 8667.352 10841.473 9809.001 11186.2015 22345.201   100
##   rwC  481.301  504.951   586.262  534.201   642.1505  1057.501   100</code></pre>
</div>
<div id="comments-your-results." class="section level3">
<h3>3. Comments your results.</h3>
<p>According to the calculation results, we find that the running time of cpp is far less than the running time of R, which greatly improves the efficiency of calculation.</p>
<p>Most of the points drawn by qqplot are located near the diagonal, so the random numbers generated by these two functions are similar.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
